function str362int(int){
	if(int.charCodeAt(0) >= 48 && int.charCodeAt(0)<= 57){
		return int.charCodeAt(0)-48;
	}else if(int.charCodeAt(0) >= 97 && int.charCodeAt(0) <= 122){
		return int.charCodeAt(0) - 97;
	}
}
function int2str36(int){
	return '0123456789abcdefghijklmnopqrstuvwxyzzzz'.charAt(int);
}

var d3landscape = [];
d3landscape['mountain1'] = '\
0111101010\n\
1221321341\n\
1456434531\n\
0122101231';
d3landscape['mountain2'] = '\
0111101010001010010010101001001\n\
1222221221222232122212121021210\n\
1222323323232322323223222322232\n\
1222323323232322323223222322232\n\
1123455453545343544554433343321\n\
1123455453545343544554433343321\n\
1123455453545343544554433343321\n\
1212122212222111222111212222111\n\
01000010011010101011010011001115';
d3landscape['mountain3'] = '\
01111010100010100100100101001010010101001001\n\
10001012212222321121112123121222212121021210\n\
00123233232323222322231432342323223222322232\n\
11234145354534355454356434543344554433343321\n\
11234545354534354455443333343542434523543321\n\
11234545354534353434253524344344554433343321\n\
10010021222312322212231222111222111211020010\n\
01000000101010022001000110101010110100110011';
d3landscape['m2'] = '\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222\n\
222222222222222222222222222222222222222222222222222222222222222222222222222222222222222';
function rad(){
	return rand()*2-0.5;
}

function loadLandscapeMap(map,landscape,k,getYn){
	landscapeMap=d3landscape[landscape];
	var w = map.split('\n').length;
	var h = map.split('\n')[0].length;
	var kw = sc['l'].length/w;
	var kh = sc['l'][0].length/h;
	for(var i = 0; i < w; i++){
		for(var j = 0; j < h; j++){
			var ck = map.split('\n')[i][j]*1;
			//log(i + ':' + j + ':' +ck);
			if(ck != 0){
				for(var ti = i*kw; ti < kw*(i+1); ti++){
					for(var tj = j*kh; tj < kh*(j+1); tj++){
							sc['l'][Math.round(ti)][Math.round(tj)] =ck*k;
					}
				}
			}
		}
	}
}

function softenMap4(){
	for(var i = 0; i < sc['lw']; i++){
		for(var j = 0; j < sc['lh']; j++){
			sc['l'][i][j] = (gxy(i+1, j  )+
							 gxy(i-1, j)+
							 gxy(i, j+1)+
							 gxy(i, j-1))/
							 4;
		}
	}
}
function softenMap8(){
	for(var i = 0; i < sc['lw']; i++){
		for(var j = 0; j < sc['lh']; j++){
			sc['l'][i][j] = (gxy(i+1, j   )+
							 gxy(i+1, j-1 )+
							 gxy(i+1, j+1 )+
							 gxy(i  , j+1 )+
							 gxy(i  , j-1 )+
							 gxy(i-1, j   )+
							 gxy(i-1, j+1 )+
							 gxy(i-1, j-1 ))/
							 8;
		}
	}
}
function softenMap82(){
	var tmp = []
	for(var i = 0; i < sc['lw']; i++){
		for(var j = 0; j < sc['lh']; j++){
			tmp[i] = []
			sc['l'][i][j] =     (gxy(i+2, j   )+
							 gxy(i+2, j-2 )+
							 gxy(i+2, j+2 )+
							 gxy(i  , j+2 )+
							 gxy(i  , j-2 )+
							 gxy(i-2, j   )+
							 gxy(i-2, j+2 )+
							 gxy(i-2, j-2 ))/
							 8;
		}
	}
}

function randomize(k){
	for(var i = 0; i < sc['lw']; i++){
		for(var j = 0; j < sc['lh']; j++){
			sc['l'][i][j] += (rand()-1)*k;
		}
	}
}
	
function addLandscapeObject(x,y,name,kz){
	for(var i = 0; i < d3landscape[name].split('\n').length; i++){
		for(var j = 0; j < d3landscape[name].split('\n')[i].length; j++){
			if(sc['l'][x+i] !== undefined && sc['l'][x+i][y+j] !== undefined){
				if(d3landscape[name].split('\n')[i][j] != '-' ){
					sc['l'][x+i][y+j] += d3landscape[name].split('\n')[i][j]*kz;
				}else{
					sc['l'][x+i][y+j] = null;
				}
			}
		}
	}
}

function gxy(x,y){
	if(sc['l'][x] !== undefined && sc['l'][x][y] !== undefined){
		var s = sc['l'][x][y];
		return s;
	}else{
		return 0;
	}
}
